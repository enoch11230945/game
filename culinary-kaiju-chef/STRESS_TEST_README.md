# 極限壓力測試指南

## 測試目標
測試遊戲在極端負載下的性能表現，包括：
- 650個敵人同時存在
- 連續射擊產生大量投射物
- 大量XP寶石生成和收集
- 物件池在高壓力下的表現

## 如何運行壓力測試

### 1. 啟動遊戲
- 打開 Godot 編輯器
- 載入 `culinary-kaiju-chef` 專案
- 運行 `src/main/main.tscn` 場景

### 2. 啟用壓力測試模式
按下 **F1** 鍵切換到壓力測試模式

### 3. 控制說明
- **F1**: 切換壓力測試模式開關
- **F2**: 強制垃圾回收（釋放物件池記憶體）
- **F3**: 顯示詳細記憶體信息
- **空白鍵**: 手動射擊（壓力測試模式下會自動射擊）

## 測試階段

### 階段 1: 50個敵人 (1-8秒)
- 生成間隔: 0.1秒
- 敵人數量: 50個
- 預期FPS: 60+

### 階段 2: 100個敵人 (8-18秒)
- 生成間隔: 0.05秒
- 敵人數量: 100個
- 預期FPS: 50-60

### 階段 3: 200個敵人 (18-32秒)
- 生成間隔: 0.02秒
- 敵人數量: 200個
- 預期FPS: 30-50

### 階段 4: 300個敵人 (32秒後)
- 生成間隔: 0.01秒
- 敵人數量: 300個
- 預期FPS: 20-30 (極限測試)

## 性能監控

遊戲會每秒輸出性能統計：
```
=== 性能統計 ===
FPS: 45
記憶體使用: 125.3 MB
敵人數量: 150
投射物數量: 25
XP寶石數量: 8
物件池使用率: 91.5%
幀數: 45
================
```

## 性能優化特性

1. **智慧分離力計算**
   - 敵人少於50個時：正常計算分離力
   - 敵人多於50個時：跳過分離力計算以提高性能

2. **物件池管理**
   - 預填充100個敵人實例
   - 預填充30個XP寶石實例
   - 動態記憶體管理

3. **自動射擊**
   - 壓力測試模式下自動連續射擊
   - 測試武器系統在高負載下的表現

## 預期結果

- **優秀**: 能維持60FPS處理200+敵人
- **良好**: 能維持30FPS處理300+敵人
- **可接受**: 能處理150+敵人而不崩潰

## 故障排除

如果遊戲在測試中崩潰：
1. 檢查記憶體使用量
2. 使用F2強制垃圾回收
3. 降低敵人生成速度
4. 檢查是否有記憶體洩漏

## 自訂測試參數

你可以在 `src/main/main.gd` 中修改：
- `spawn_radius`: 敵人生成半徑
- 波次時間和數量
- 性能監控間隔
